{"openapi":"3.0.1","info":{"title":"Prison Register service","description":"A service that provides HMPPS Prison Information","contact":{"name":"HMPPS Digital Studio","email":"feedback@digital.justice.gov.uk"},"version":"2022-05-19.1934.2a6ee98"},"servers":[{"url":"https://prison-register-dev.hmpps.service.justice.gov.uk","description":"Generated server url"}],"paths":{"/secure/prisons/id/{prisonId}/videolink-conferencing-centre/email-address":{"get":{"tags":["prison-email-resource"],"summary":"Get a prison's Videolink Conferencing Centre email address","operationId":"getEmailForVideoConferencingCentre","parameters":[{"name":"prisonId","in":"path","required":true,"schema":{"maxLength":12,"minLength":2,"type":"string","description":"Prison ID","example":"MDI"}}],"responses":{"404":{"description":"The prison does not have a Videolink Conferencing Centre email address","content":{"text/plain":{"schema":{"type":"string"}}}},"400":{"description":"Client error - invalid prisonId or similar","content":{"text/plain":{"schema":{"type":"string"}}}},"200":{"description":"Returns the email address","content":{"text/plain":{}}}}},"put":{"tags":["prison-email-resource"],"summary":"Set or change a prison's Videolink Conferencing Centre email address","operationId":"putEmailAddressForVideolinkConferencingCentre","parameters":[{"name":"prisonId","in":"path","required":true,"schema":{"maxLength":12,"minLength":2,"type":"string","description":"Prison ID","example":"MDI"}}],"requestBody":{"content":{"text/plain":{"schema":{"type":"string","description":"Email address","example":"a@b.com"}}},"required":true},"responses":{"201":{"description":"The email address was created"},"404":{"description":"No prison found for the supplied prison id"},"204":{"description":"The email address was updated"},"400":{"description":"Client error - invalid prisonId, email address or similar"}}},"delete":{"tags":["prison-email-resource"],"summary":"Remove a prison's Videolink Conferencing Centre email address","operationId":"deleteEmailAddressForVideolinkConferencingCentre","parameters":[{"name":"prisonId","in":"path","required":true,"schema":{"maxLength":12,"minLength":2,"type":"string","description":"Prison ID","example":"MDI"}}],"responses":{"204":{"description":"The email address was removed"},"400":{"description":"Client error - invalid prisonId or similar"}}}},"/secure/prisons/id/{prisonId}/offender-management-unit/email-address":{"get":{"tags":["prison-email-resource"],"summary":"Get a prison's Offender Management Unit email address","operationId":"getEmailForOffenderManagementUnit","parameters":[{"name":"prisonId","in":"path","required":true,"schema":{"maxLength":12,"minLength":2,"type":"string","description":"Prison ID","example":"MDI"}}],"responses":{"400":{"description":"Client error - invalid prisonId or similar","content":{"text/plain":{"schema":{"type":"string"}}}},"404":{"description":"The prison does not have a Offender Management Unit email address","content":{"text/plain":{"schema":{"type":"string"}}}},"200":{"description":"Returns the email address","content":{"text/plain":{}}}}},"put":{"tags":["prison-email-resource"],"summary":"Set or change a prison's Offender Management Unit email address","operationId":"putEmailAddressForOffenderManagementUnit","parameters":[{"name":"prisonId","in":"path","required":true,"schema":{"maxLength":12,"minLength":2,"type":"string","description":"Prison ID","example":"MDI"}}],"requestBody":{"content":{"text/plain":{"schema":{"type":"string","description":"Email address","example":"a@b.com"}}},"required":true},"responses":{"201":{"description":"The email address was created"},"404":{"description":"No prison found for the supplied prison id"},"400":{"description":"Client error - invalid prisonId, email address, media type or similar"},"204":{"description":"The email address was updated"}}},"delete":{"tags":["prison-email-resource"],"summary":"Remove a prison's Offender Management Unit email address","operationId":"deleteEmailAddressForOffenderManagementUnit","parameters":[{"name":"prisonId","in":"path","required":true,"schema":{"maxLength":12,"minLength":2,"type":"string","description":"Prison ID","example":"MDI"}}],"responses":{"204":{"description":"The email address was removed"},"400":{"description":"Client error - invalid prisonId or similar"}}}},"/queue-admin/retry-dlq/{dlqName}":{"put":{"tags":["hmpps-queue-resource"],"operationId":"retryDlq","parameters":[{"name":"dlqName","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/RetryDlqResult"}}}}}}},"/queue-admin/retry-all-dlqs":{"put":{"tags":["hmpps-queue-resource"],"operationId":"retryAllDlqs","responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/RetryDlqResult"}}}}}}}},"/queue-admin/purge-queue/{queueName}":{"put":{"tags":["hmpps-queue-resource"],"operationId":"purgeQueue","parameters":[{"name":"queueName","in":"path","required":true,"schema":{"type":"string"}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/PurgeQueueResult"}}}}}}},"/prison-maintenance/id/{prisonId}":{"put":{"tags":["prison-maintenance-resource"],"summary":"Update specified prison details","description":"Updates prison information, role required is MAINTAIN_REF_DATA","operationId":"updatePrison","parameters":[{"name":"prisonId","in":"path","required":true,"schema":{"maxLength":6,"minLength":3,"type":"string","description":"Prison Id","example":"MDI"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdatePrisonDto"}}},"required":true},"responses":{"200":{"description":"Prison Information Updated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PrisonDto"}}}},"400":{"description":"Information request to update prison","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Unauthorized to access this endpoint","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Incorrect permissions to make prison update","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Prison ID not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"MAINTAIN_REF_DATA":["write"]}]}},"/prison-maintenance/id/{prisonId}/address/{addressId}":{"put":{"tags":["prison-address-maintenance-resource"],"summary":"Update specified address details","description":"Updates address information, role required is MAINTAIN_REF_DATA","operationId":"updateAddress","parameters":[{"name":"prisonId","in":"path","required":true,"schema":{"maxLength":6,"minLength":3,"type":"string","description":"Prison Id","example":"MDI"}},{"name":"addressId","in":"path","required":true,"schema":{"type":"integer","description":"Address Id","format":"int64","example":234231}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateAddressDto"}}},"required":true},"responses":{"200":{"description":"Address Information Updated","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AddressDto"}}}},"400":{"description":"Bad Information request to update address","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Unauthorized to access this endpoint","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Incorrect permissions to make address update","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Address Id not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"MAINTAIN_REF_DATA":["write"]}]},"delete":{"tags":["prison-address-maintenance-resource"],"summary":"Delete specified address for specified Prison","description":"Deletes address information for a Prison, role required is MAINTAIN_REF_DATA","operationId":"deleteAddress","parameters":[{"name":"prisonId","in":"path","required":true,"schema":{"maxLength":6,"minLength":3,"type":"string","description":"Prison Id","example":"MDI"}},{"name":"addressId","in":"path","required":true,"schema":{"type":"integer","description":"Address Id","format":"int64","example":234231}}],"responses":{"200":{"description":"Address Information Deleted"},"401":{"description":"Unauthorized to access this endpoint","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Incorrect permissions to make address update","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Address Id not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"MAINTAIN_REF_DATA":["write"]}]}},"/prison-maintenance":{"post":{"tags":["prison-maintenance-resource"],"summary":"Adds a new prison","description":"Adds new prison information, role required is MAINTAIN_REF_DATA","operationId":"insertPrison","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/InsertPrisonDto"}}},"required":true},"responses":{"201":{"description":"Prison Information Inserted","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PrisonDto"}}}},"400":{"description":"Information request to add prison","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Unauthorized to access this endpoint","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Incorrect permissions to make prison insert","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"MAINTAIN_REF_DATA":["write"]}]}},"/prison-maintenance/id/{prisonId}/address":{"post":{"tags":["prison-address-maintenance-resource"],"summary":"Add Address to existing Prison","description":"Adds an additional Address to an existing Prison, role required is MAINTAIN_REF_DATA","operationId":"addAddress","parameters":[{"name":"prisonId","in":"path","required":true,"schema":{"maxLength":6,"minLength":3,"type":"string","description":"Prison Id","example":"MDI"}}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/UpdateAddressDto"}}},"required":true},"responses":{"200":{"description":"New Address added to Prison","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AddressDto"}}}},"400":{"description":"Bad Information request to update address","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"401":{"description":"Unauthorized to access this endpoint","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"403":{"description":"Incorrect permissions to add Prison address","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"Prison Id not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}},"security":[{"MAINTAIN_REF_DATA":["write"]}]}},"/queue-admin/get-dlq-messages/{dlqName}":{"get":{"tags":["hmpps-queue-resource"],"operationId":"getDlqMessages","parameters":[{"name":"dlqName","in":"path","required":true,"schema":{"type":"string"}},{"name":"maxMessages","in":"query","required":false,"schema":{"type":"integer","format":"int32","default":100}}],"responses":{"200":{"description":"OK","content":{"*/*":{"schema":{"$ref":"#/components/schemas/GetDlqResult"}}}}}}},"/prisons":{"get":{"tags":["prison-resource"],"summary":"Get all prisons","description":"All prisons","operationId":"getPrisons","responses":{"200":{"description":"Successful Operation","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/PrisonDto"}}}}}}}},"/prisons/search":{"get":{"tags":["prison-resource"],"summary":"Get prisons from active and text search","description":"All prisons","operationId":"getPrisonsBySearchFilter","parameters":[{"name":"active","in":"query","description":"Active","required":false,"schema":{"type":"boolean"},"example":true},{"name":"textSearch","in":"query","description":"Text search","required":false,"schema":{"type":"string"},"example":"Sheffield"},{"name":"genders","in":"query","description":"Genders to filter by","required":false,"schema":{"type":"array","items":{"type":"string","enum":["MALE","FEMALE"]}},"example":"MALE, FEMALE"},{"name":"prisonTypeCodes","in":"query","description":"Prison type codes to filter by","required":false,"schema":{"type":"array","items":{"type":"string","enum":["HMP","YOI","IRC","STC","YCS"]}},"example":"HMP, YOI"}],"responses":{"200":{"description":"Successful Operation","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/PrisonDto"}}}}}}}},"/prisons/id/{prisonId}":{"get":{"tags":["prison-resource"],"summary":"Get specified prison","description":"Information on a specific prison","operationId":"getPrisonFromId","parameters":[{"name":"prisonId","in":"path","required":true,"schema":{"maxLength":6,"minLength":3,"type":"string","description":"Prison ID","example":"MDI"}}],"responses":{"200":{"description":"Successful Operation","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PrisonDto"}}}}}}},"/prisons/id/{prisonId}/address/{addressId}":{"get":{"tags":["prison-resource"],"summary":"Get specified prison","description":"Information on a specific prison address","operationId":"getAddressFromId","parameters":[{"name":"prisonId","in":"path","required":true,"schema":{"maxLength":6,"minLength":3,"type":"string","description":"Prison ID","example":"MDI"}},{"name":"addressId","in":"path","required":true,"schema":{"type":"integer","description":"Address Id","format":"int64","example":234231}}],"responses":{"200":{"description":"Successful Operation","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AddressDto"}}}}}}},"/gp/prison/{prisonId}":{"get":{"tags":["gp-resource"],"summary":"Get GP practice code about specified prison","operationId":"getPrisonFromId_1","parameters":[{"name":"prisonId","in":"path","description":"Prison ID","required":true,"schema":{"maxLength":12,"minLength":2,"type":"string"},"example":"MDI"}],"responses":{"404":{"description":"Prison not found.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"400":{"description":"Bad request.  Wrong format for prison_id.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}},"/gp/practice/{gpPracticeCode}":{"get":{"tags":["gp-resource"],"summary":"Get specified prison from GP practice code","operationId":"getPrisonFromGpPrescriber","parameters":[{"name":"gpPracticeCode","in":"path","description":"GP Practice Code","required":true,"schema":{"maxLength":6,"minLength":0,"type":"string"},"example":"Y05537"}],"responses":{"400":{"description":"Bad request.  Wrong format for GP practice code.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}},"404":{"description":"No prison linked to the GP practice code.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ErrorResponse"}}}}}}}},"components":{"schemas":{"Message":{"type":"object","properties":{"messageId":{"type":"string"},"receiptHandle":{"type":"string"},"body":{"type":"string"},"attributes":{"type":"object","additionalProperties":{"type":"string"}},"messageAttributes":{"type":"object","additionalProperties":{"$ref":"#/components/schemas/MessageAttributeValue"}},"md5OfBody":{"type":"string"},"md5OfMessageAttributes":{"type":"string"}}},"MessageAttributeValue":{"type":"object","properties":{"stringValue":{"type":"string"},"binaryValue":{"type":"object","properties":{"short":{"type":"integer","format":"int32"},"char":{"type":"string"},"int":{"type":"integer","format":"int32"},"long":{"type":"integer","format":"int64"},"float":{"type":"number","format":"float"},"double":{"type":"number","format":"double"},"direct":{"type":"boolean"},"readOnly":{"type":"boolean"}}},"stringListValues":{"type":"array","items":{"type":"string"}},"binaryListValues":{"type":"array","items":{"type":"object","properties":{"short":{"type":"integer","format":"int32"},"char":{"type":"string"},"int":{"type":"integer","format":"int32"},"long":{"type":"integer","format":"int64"},"float":{"type":"number","format":"float"},"double":{"type":"number","format":"double"},"direct":{"type":"boolean"},"readOnly":{"type":"boolean"}}}},"dataType":{"type":"string"}}},"RetryDlqResult":{"required":["messages","messagesFoundCount"],"type":"object","properties":{"messagesFoundCount":{"type":"integer","format":"int32"},"messages":{"type":"array","items":{"$ref":"#/components/schemas/Message"}}}},"PurgeQueueResult":{"required":["messagesFoundCount"],"type":"object","properties":{"messagesFoundCount":{"type":"integer","format":"int32"}}},"UpdatePrisonDto":{"required":["active","contracted","female","male","prisonName","prisonTypes"],"type":"object","properties":{"prisonName":{"maxLength":40,"minLength":3,"type":"string","description":"Name of the prison","example":"HMP Moorland"},"active":{"type":"boolean","description":"Whether the prison is still active"},"male":{"type":"boolean","description":"If this is a male prison"},"female":{"type":"boolean","description":"If this is a female prison"},"contracted":{"type":"boolean","description":"If this is a contracted prison"},"prisonTypes":{"uniqueItems":true,"type":"array","description":"Set of types for this prison","items":{"type":"string","description":"Set of types for this prison","enum":["HMP","YOI","IRC","STC","YCS"]}}},"description":"Prison Update Record"},"ErrorResponse":{"required":["status"],"type":"object","properties":{"status":{"type":"integer","format":"int32"},"errorCode":{"type":"integer","format":"int32"},"userMessage":{"type":"string"},"developerMessage":{"type":"string"},"moreInfo":{"type":"string"}}},"AddressDto":{"required":["country","id","postcode","town"],"type":"object","properties":{"id":{"type":"integer","description":"Unique ID of the address","format":"int64","example":10000},"addressLine1":{"type":"string","description":"Address line 1","example":"Bawtry Road"},"addressLine2":{"type":"string","description":"Address line 2","example":"Hatfield Woodhouse"},"town":{"type":"string","description":"Village/Town/City","example":"Doncaster"},"county":{"type":"string","description":"County","example":"South Yorkshire"},"postcode":{"type":"string","description":"Postcode","example":"DN7 6BW"},"country":{"type":"string","description":"Country","example":"England"}},"description":"List of address for this prison"},"PrisonDto":{"required":["active","addresses","contracted","female","male","prisonId","prisonName","types"],"type":"object","properties":{"prisonId":{"type":"string","description":"Prison ID","example":"MDI"},"prisonName":{"type":"string","description":"Name of the prison","example":"Moorland HMP"},"active":{"type":"boolean","description":"Whether the prison is still active"},"male":{"type":"boolean","description":"Whether the prison has male prisoners"},"female":{"type":"boolean","description":"Whether the prison has female prisoners"},"contracted":{"type":"boolean","description":"Whether the prison is contracted"},"types":{"type":"array","description":"List of types for this prison","items":{"$ref":"#/components/schemas/PrisonTypeDto"}},"addresses":{"type":"array","description":"List of address for this prison","items":{"$ref":"#/components/schemas/AddressDto"}}},"description":"Prison Information"},"PrisonTypeDto":{"required":["code","description"],"type":"object","properties":{"code":{"type":"string","description":"Prison type code","example":"HMP","enum":["HMP","YOI","IRC","STC","YCS"]},"description":{"type":"string","description":"Prison type description","example":"Her Majesty’s Prison"}},"description":"List of types for this prison"},"UpdateAddressDto":{"required":["country","postcode","town"],"type":"object","properties":{"addressLine1":{"maxLength":80,"minLength":0,"type":"string","description":"Address line 1","example":"Bawtry Road"},"addressLine2":{"maxLength":80,"minLength":0,"type":"string","description":"Address line 2","example":"Hatfield Woodhouse"},"town":{"maxLength":80,"minLength":0,"type":"string","description":"Village/Town/City","example":"Doncaster"},"county":{"maxLength":80,"minLength":0,"type":"string","description":"County","example":"South Yorkshire"},"postcode":{"maxLength":8,"minLength":0,"type":"string","description":"Postcode","example":"DN7 6BW"},"country":{"maxLength":16,"minLength":0,"type":"string","description":"Country","example":"England"}},"description":"Address Update Record"},"InsertPrisonDto":{"required":["active","addresses","contracted","female","male","prisonId","prisonName","prisonTypes"],"type":"object","properties":{"prisonId":{"maxLength":6,"minLength":3,"type":"string","description":"Prison Id","example":"MDI"},"prisonName":{"maxLength":40,"minLength":3,"type":"string","description":"Name of the prison","example":"HMP Moorland"},"active":{"type":"boolean","description":"Whether the prison is still active"},"male":{"type":"boolean","description":"If this is a male prison"},"female":{"type":"boolean","description":"If this is a female prison"},"contracted":{"type":"boolean","description":"If this is a contracted prison"},"prisonTypes":{"uniqueItems":true,"type":"array","description":"Set of types for this prison","example":"HMP","items":{"type":"string","description":"Set of types for this prison","example":"HMP","enum":["HMP","YOI","IRC","STC","YCS"]}},"addresses":{"type":"array","description":"List of addresses for this prison","items":{"$ref":"#/components/schemas/UpdateAddressDto"}}},"description":"Prison Insert Record"},"DlqMessage":{"required":["body","messageId"],"type":"object","properties":{"body":{"type":"object","additionalProperties":{"type":"object"}},"messageId":{"type":"string"}}},"GetDlqResult":{"required":["messages","messagesFoundCount","messagesReturnedCount"],"type":"object","properties":{"messagesFoundCount":{"type":"integer","format":"int32"},"messagesReturnedCount":{"type":"integer","format":"int32"},"messages":{"type":"array","items":{"$ref":"#/components/schemas/DlqMessage"}}}}}}}